DROP DATABASE IF EXISTS mcol3758;
CREATE DATABASE mcol3758;
USE mcol3758;
SET columnstore_orderby_threads=1;
DROP TABLE IF EXISTS `sorting_numerics`;
CREATE TABLE `sorting_test`(
`bint` BIGINT,
`dbl` DOUBLE,
`dec` DECIMAL(18),
tcolumn TEXT,
vcolumn VARCHAR(100),
vc7 VARCHAR(7),
ch7 CHAR(7),
`tscolumn` TIMESTAMP
) ENGINE=columnstore;
INSERT INTO `sorting_test`
-- (`bint`,`db`,`dec`,`udec`,tcolumn,vcolumn,vc7,ch7,dcolumn,tscolumn)
(`bint`,`dbl`, tcolumn)
VALUES
(42, 42.0,'one'),
(-9223372036854775806, -9223372036854775808.0,NULL),
(9223372036854775807, 1.7976931348623157E+308,'two'),
(42, 1.7976931348623157E+308,'42'),
(NULL, 42.0,NULL),
(-9223372036854775806, NULL,'one '),
(42,42.0,'forty five'),
( 42,-9223372036854775808.0,'causes damage'),
( NULL,-1.7976931348623157E+308,'4th ree'),
( -9223372036854775806,-9223372036854775808.0,'sorty five'),
( NULL, 1.7976931348623157E+308,'cornnh'),
( -9223372036854775806,NULL,'one'),
( 0,-9223372036854775808.0,'two'),
( -20,NULL,'pappad'),
( -9223372036854775806,42.0,'two'),
( 9223372036854775807,9223372036854775808.0,'4th ree'),
( NULL,-9223372036854775808.0,'one');
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 1 DESC,2 DESC;
bint	dbl
9223372036854775807	1.7976931348623157e308
9223372036854775807	9.223372036854776e18
42	1.7976931348623157e308
42	42
42	42
42	-9.223372036854776e18
0	-9.223372036854776e18
-9223372036854775806	42
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 1 DESC,2;
bint	dbl
9223372036854775807	9.223372036854776e18
9223372036854775807	1.7976931348623157e308
42	-9.223372036854776e18
42	42
42	42
42	1.7976931348623157e308
0	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	42
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 1,2 DESC;
bint	dbl
-9223372036854775806	42
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
0	-9.223372036854776e18
42	1.7976931348623157e308
42	42
42	42
42	-9.223372036854776e18
9223372036854775807	1.7976931348623157e308
9223372036854775807	9.223372036854776e18
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 1,2;
bint	dbl
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	42
0	-9.223372036854776e18
42	-9.223372036854776e18
42	42
42	42
42	1.7976931348623157e308
9223372036854775807	9.223372036854776e18
9223372036854775807	1.7976931348623157e308
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 2 DESC,1 DESC;
bint	dbl
9223372036854775807	1.7976931348623157e308
42	1.7976931348623157e308
9223372036854775807	9.223372036854776e18
42	42
42	42
-9223372036854775806	42
42	-9.223372036854776e18
0	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 2 DESC,1;
bint	dbl
42	1.7976931348623157e308
9223372036854775807	1.7976931348623157e308
9223372036854775807	9.223372036854776e18
-9223372036854775806	42
42	42
42	42
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
0	-9.223372036854776e18
42	-9.223372036854776e18
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 2,1 DESC;
bint	dbl
42	-9.223372036854776e18
0	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
42	42
42	42
-9223372036854775806	42
9223372036854775807	9.223372036854776e18
9223372036854775807	1.7976931348623157e308
42	1.7976931348623157e308
select bint,dbl from sorting_test where bint is not null and dbl is not null order by 2,1;
bint	dbl
-9223372036854775806	-9.223372036854776e18
-9223372036854775806	-9.223372036854776e18
0	-9.223372036854776e18
42	-9.223372036854776e18
-9223372036854775806	42
42	42
42	42
9223372036854775807	9.223372036854776e18
42	1.7976931348623157e308
9223372036854775807	1.7976931348623157e308
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 1 DESC,2 DESC;
bint	hex(tcolumn)
9223372036854775807	74776F
9223372036854775807	34746820726565
42	6F6E65
42	666F7274792066697665
42	6361757365732064616D616765
42	3432
0	74776F
-20	706170706164
-9223372036854775806	74776F
-9223372036854775806	736F7274792066697665
-9223372036854775806	6F6E6520
-9223372036854775806	6F6E65
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 1 DESC,2;
bint	hex(tcolumn)
9223372036854775807	34746820726565
9223372036854775807	74776F
42	3432
42	6361757365732064616D616765
42	666F7274792066697665
42	6F6E65
0	74776F
-20	706170706164
-9223372036854775806	6F6E65
-9223372036854775806	6F6E6520
-9223372036854775806	736F7274792066697665
-9223372036854775806	74776F
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 1,2 DESC;
bint	hex(tcolumn)
-9223372036854775806	74776F
-9223372036854775806	736F7274792066697665
-9223372036854775806	6F6E6520
-9223372036854775806	6F6E65
-20	706170706164
0	74776F
42	6F6E65
42	666F7274792066697665
42	6361757365732064616D616765
42	3432
9223372036854775807	74776F
9223372036854775807	34746820726565
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 1,2;
bint	hex(tcolumn)
-9223372036854775806	6F6E65
-9223372036854775806	6F6E6520
-9223372036854775806	736F7274792066697665
-9223372036854775806	74776F
-20	706170706164
0	74776F
42	3432
42	6361757365732064616D616765
42	666F7274792066697665
42	6F6E65
9223372036854775807	34746820726565
9223372036854775807	74776F
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 2 DESC,1 DESC;
bint	hex(tcolumn)
9223372036854775807	74776F
0	74776F
-9223372036854775806	74776F
-9223372036854775806	736F7274792066697665
-20	706170706164
-9223372036854775806	6F6E6520
42	6F6E65
-9223372036854775806	6F6E65
42	666F7274792066697665
42	6361757365732064616D616765
9223372036854775807	34746820726565
42	3432
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 2 DESC,1;
bint	hex(tcolumn)
-9223372036854775806	74776F
0	74776F
9223372036854775807	74776F
-9223372036854775806	736F7274792066697665
-20	706170706164
-9223372036854775806	6F6E6520
-9223372036854775806	6F6E65
42	6F6E65
42	666F7274792066697665
42	6361757365732064616D616765
9223372036854775807	34746820726565
42	3432
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 2,1 DESC;
bint	hex(tcolumn)
42	3432
9223372036854775807	34746820726565
42	6361757365732064616D616765
42	666F7274792066697665
42	6F6E65
-9223372036854775806	6F6E65
-9223372036854775806	6F6E6520
-20	706170706164
-9223372036854775806	736F7274792066697665
9223372036854775807	74776F
0	74776F
-9223372036854775806	74776F
select bint,hex(tcolumn) from sorting_test where bint is not null and tcolumn is not null order by 2,1;
bint	hex(tcolumn)
42	3432
9223372036854775807	34746820726565
42	6361757365732064616D616765
42	666F7274792066697665
-9223372036854775806	6F6E65
42	6F6E65
-9223372036854775806	6F6E6520
-20	706170706164
-9223372036854775806	736F7274792066697665
-9223372036854775806	74776F
0	74776F
9223372036854775807	74776F
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 1 DESC,2 DESC;
dbl	hex(tcolumn)
1.7976931348623157e308	74776F
1.7976931348623157e308	636F726E6E68
1.7976931348623157e308	3432
9.223372036854776e18	34746820726565
42	74776F
42	6F6E65
42	666F7274792066697665
-9.223372036854776e18	74776F
-9.223372036854776e18	736F7274792066697665
-9.223372036854776e18	6F6E65
-9.223372036854776e18	6361757365732064616D616765
-1.7976931348623157e308	34746820726565
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 1 DESC,2;
dbl	hex(tcolumn)
1.7976931348623157e308	3432
1.7976931348623157e308	636F726E6E68
1.7976931348623157e308	74776F
9.223372036854776e18	34746820726565
42	666F7274792066697665
42	6F6E65
42	74776F
-9.223372036854776e18	6361757365732064616D616765
-9.223372036854776e18	6F6E65
-9.223372036854776e18	736F7274792066697665
-9.223372036854776e18	74776F
-1.7976931348623157e308	34746820726565
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 1,2 DESC;
dbl	hex(tcolumn)
-1.7976931348623157e308	34746820726565
-9.223372036854776e18	74776F
-9.223372036854776e18	736F7274792066697665
-9.223372036854776e18	6F6E65
-9.223372036854776e18	6361757365732064616D616765
42	74776F
42	6F6E65
42	666F7274792066697665
9.223372036854776e18	34746820726565
1.7976931348623157e308	74776F
1.7976931348623157e308	636F726E6E68
1.7976931348623157e308	3432
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 1,2;
dbl	hex(tcolumn)
-1.7976931348623157e308	34746820726565
-9.223372036854776e18	6361757365732064616D616765
-9.223372036854776e18	6F6E65
-9.223372036854776e18	736F7274792066697665
-9.223372036854776e18	74776F
42	666F7274792066697665
42	6F6E65
42	74776F
9.223372036854776e18	34746820726565
1.7976931348623157e308	3432
1.7976931348623157e308	636F726E6E68
1.7976931348623157e308	74776F
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 2 DESC,1 DESC;
dbl	hex(tcolumn)
1.7976931348623157e308	74776F
42	74776F
-9.223372036854776e18	74776F
-9.223372036854776e18	736F7274792066697665
42	6F6E65
-9.223372036854776e18	6F6E65
42	666F7274792066697665
1.7976931348623157e308	636F726E6E68
-9.223372036854776e18	6361757365732064616D616765
9.223372036854776e18	34746820726565
-1.7976931348623157e308	34746820726565
1.7976931348623157e308	3432
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 2 DESC,1;
dbl	hex(tcolumn)
-9.223372036854776e18	74776F
42	74776F
1.7976931348623157e308	74776F
-9.223372036854776e18	736F7274792066697665
-9.223372036854776e18	6F6E65
42	6F6E65
42	666F7274792066697665
1.7976931348623157e308	636F726E6E68
-9.223372036854776e18	6361757365732064616D616765
-1.7976931348623157e308	34746820726565
9.223372036854776e18	34746820726565
1.7976931348623157e308	3432
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 2,1 DESC;
dbl	hex(tcolumn)
1.7976931348623157e308	3432
9.223372036854776e18	34746820726565
-1.7976931348623157e308	34746820726565
-9.223372036854776e18	6361757365732064616D616765
1.7976931348623157e308	636F726E6E68
42	666F7274792066697665
42	6F6E65
-9.223372036854776e18	6F6E65
-9.223372036854776e18	736F7274792066697665
1.7976931348623157e308	74776F
42	74776F
-9.223372036854776e18	74776F
select dbl,hex(tcolumn) from sorting_test where dbl is not null and tcolumn is not null order by 2,1;
dbl	hex(tcolumn)
1.7976931348623157e308	3432
-1.7976931348623157e308	34746820726565
9.223372036854776e18	34746820726565
-9.223372036854776e18	6361757365732064616D616765
1.7976931348623157e308	636F726E6E68
42	666F7274792066697665
-9.223372036854776e18	6F6E65
42	6F6E65
-9.223372036854776e18	736F7274792066697665
-9.223372036854776e18	74776F
42	74776F
1.7976931348623157e308	74776F
DROP TABLE `sorting_test`;
DROP DATABASE mcol3758;
