DROP DATABASE IF EXISTS mcol3758;
CREATE DATABASE mcol3758;
USE mcol3758;
SET columnstore_orderby_threads=1;
DROP TABLE IF EXISTS `sorting_numerics`;
CREATE TABLE `sorting_numerics`(
`tint` TINYINT,
`smint` SMALLINT,
`iint` INT,
`bint` BIGINT,
`utint` TINYINT UNSIGNED,
`usmint` SMALLINT UNSIGNED,
`uiint` INT UNSIGNED,
`ubint` BIGINT UNSIGNED,
`fl` FLOAT,
`db` DOUBLE,
`dec` DECIMAL(18),
`udec` DECIMAL(18) UNSIGNED
) ENGINE=columnstore;
INSERT INTO `sorting_numerics`
(`tint`,`smint`,`iint`,`bint`,`utint`,`usmint`,`uiint`,`ubint`,`fl`,`db`,`dec`,`udec`)
VALUES
(-1,-129,-65385,-4294967297,1,129,65385,4294967297,1.0,1.0,-1,1),
(1,129,65385,4294967297,1,129,65385,4294967297,-1.0,-1.0,1,1),
(NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL),
(-42,-170,-65422,-4294967344,42,170,65422,4294967344,42.0,42.0,-42,42),
(42,170,65422,4294967344,42,170,65422,4294967344,-42.0,-42.0,42,42),
(-5,-133,-65389,-4294967301,5,133,65389,4294967301,-5.0,-5.0,-5,5),
(5,133,65389,4294967301,5,133,65389,4294967301,5.0,5.0,5,5),
(NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL);
SELECT `tint` FROM `sorting_numerics` ORDER BY tint DESC;
tint
42
5
1
-1
-5
-42
NULL
NULL
SELECT `tint` FROM `sorting_numerics` ORDER BY tint ASC;
tint
NULL
NULL
-42
-5
-1
1
5
42
SELECT `smint` FROM `sorting_numerics` ORDER BY smint DESC;
smint
170
133
129
-129
-133
-170
NULL
NULL
SELECT `smint` FROM `sorting_numerics` ORDER BY smint ASC;
smint
NULL
NULL
-170
-133
-129
129
133
170
SELECT `iint` FROM `sorting_numerics` ORDER BY iint DESC;
iint
65422
65389
65385
-65385
-65389
-65422
NULL
NULL
SELECT `iint` FROM `sorting_numerics` ORDER BY iint ASC;
iint
NULL
NULL
-65422
-65389
-65385
65385
65389
65422
SELECT `bint` FROM `sorting_numerics` ORDER BY bint DESC;
bint
4294967344
4294967301
4294967297
-4294967297
-4294967301
-4294967344
NULL
NULL
SELECT `bint` FROM `sorting_numerics` ORDER BY bint ASC;
bint
NULL
NULL
-4294967344
-4294967301
-4294967297
4294967297
4294967301
4294967344
SELECT `utint` FROM `sorting_numerics` ORDER BY utint DESC;
utint
42
42
5
5
1
1
NULL
NULL
SELECT `utint` FROM `sorting_numerics` ORDER BY utint ASC;
utint
NULL
NULL
1
1
5
5
42
42
SELECT `usmint` FROM `sorting_numerics` ORDER BY usmint DESC;
usmint
170
170
133
133
129
129
NULL
NULL
SELECT `usmint` FROM `sorting_numerics` ORDER BY usmint ASC;
usmint
NULL
NULL
129
129
133
133
170
170
SELECT `uiint` FROM `sorting_numerics` ORDER BY uiint DESC;
uiint
65422
65422
65389
65389
65385
65385
NULL
NULL
SELECT `uiint` FROM `sorting_numerics` ORDER BY uiint ASC;
uiint
NULL
NULL
65385
65385
65389
65389
65422
65422
SELECT `ubint` FROM `sorting_numerics` ORDER BY ubint DESC;
ubint
4294967344
4294967344
4294967301
4294967301
4294967297
4294967297
NULL
NULL
SELECT `ubint` FROM `sorting_numerics` ORDER BY ubint ASC;
ubint
NULL
NULL
4294967297
4294967297
4294967301
4294967301
4294967344
4294967344
SELECT `fl` FROM `sorting_numerics` ORDER BY fl DESC;
fl
42
5
1
-1
-5
-42
NULL
NULL
SELECT `fl` FROM `sorting_numerics` ORDER BY fl ASC;
fl
NULL
NULL
-42
-5
-1
1
5
42
SELECT `db` FROM `sorting_numerics` ORDER BY db DESC;
db
42
5
1
-1
-5
-42
NULL
NULL
SELECT `db` FROM `sorting_numerics` ORDER BY db ASC;
db
NULL
NULL
-42
-5
-1
1
5
42
SELECT `dec` FROM `sorting_numerics` ORDER BY `dec` DESC;
dec
42
5
1
-1
-5
-42
NULL
NULL
SELECT `dec` FROM `sorting_numerics` ORDER BY `dec` ASC;
dec
NULL
NULL
-42
-5
-1
1
5
42
SELECT `udec` FROM `sorting_numerics` ORDER BY udec DESC;
udec
42
42
5
5
1
1
NULL
NULL
SELECT `udec` FROM `sorting_numerics` ORDER BY udec ASC;
udec
NULL
NULL
1
1
5
5
42
42
DROP TABLE IF EXISTS `sorting_chars`;
CREATE TABLE `sorting_chars`(
tcolumn TEXT,
vcolumn VARCHAR(100),
vc7 VARCHAR(7),
ch7 CHAR(7)
) ENGINE=columnstore DEFAULT CHARSET=latin1;
INSERT INTO `sorting_chars`
(`tcolumn`,`vcolumn`, `vc7`, `ch7`)
VALUES
('one','two','three', 'afour'),
(' one','two ','4th ree', ' four '),
(' one','two',NULL, NULL),
(NULL,NULL, 'bb b', ' aaa '),
(' one','two ','4th ree', 'five '),
('two','one', NULL, NULL),
('ccccc','deac', 'ccccc ', 'haf'),
(NULL,NULL, 'ccccc ', 'four'),
('two','one', 'three', 'four'),
('one','two', 'four', 'three'),
(NULL,'one', 'bb b', 'zAz'),
(NULL,NULL, NULL, NULL);
SELECT `tcolumn` FROM `sorting_chars` WHERE `tcolumn` IS NOT NULL ORDER BY `tcolumn` DESC;
tcolumn
two
two
one
one
ccccc
 one
 one
 one
SELECT `tcolumn` FROM `sorting_chars` WHERE `tcolumn` IS NOT NULL ORDER BY `tcolumn` ASC;
tcolumn
 one
 one
 one
ccccc
one
one
two
two
SELECT vcolumn,hex(`vcolumn`) FROM `sorting_chars` WHERE `vcolumn` IS NOT NULL ORDER BY`vcolumn` DESC;
vcolumn	hex(`vcolumn`)
two	74776F
two 	74776F20
two	74776F
two 	74776F20
two	74776F
one	6F6E65
one	6F6E65
one	6F6E65
deac	64656163
SELECT vcolumn,hex(`vcolumn`) FROM `sorting_chars` WHERE `vcolumn` IS NOT NULL ORDER BY`vcolumn` ASC;
vcolumn	hex(`vcolumn`)
deac	64656163
one	6F6E65
one	6F6E65
one	6F6E65
two	74776F
two 	74776F20
two	74776F
two 	74776F20
two	74776F
SELECT `vc7`,hex(vc7) FROM `sorting_chars` WHERE `vc7` IS NOT NULL ORDER BY `vc7` DESC;
vc7	hex(vc7)
three	7468726565
three	7468726565
four	666F7572
ccccc 	636363636320
ccccc 	636363636320
bb b	62622062
bb b	62622062
4th ree	34746820726565
4th ree	34746820726565
SELECT `vc7`,hex(vc7) FROM `sorting_chars` WHERE `vc7` IS NOT NULL ORDER BY `vc7` ASC;
vc7	hex(vc7)
4th ree	34746820726565
4th ree	34746820726565
bb b	62622062
bb b	62622062
ccccc 	636363636320
ccccc 	636363636320
four	666F7572
three	7468726565
three	7468726565
SELECT `ch7`,hex(ch7) FROM `sorting_chars` WHERE `ch7` IS NOT NULL ORDER BY `ch7` DESC;
ch7	hex(ch7)
zAz	7A417A
three	7468726565
haf	686166
four	666F7572
four	666F7572
five	66697665
afour	61666F7572
 four	20666F7572
 aaa	20616161
SELECT `ch7`,hex(ch7) FROM `sorting_chars` WHERE `ch7` IS NOT NULL ORDER BY `ch7` ASC;
ch7	hex(ch7)
 aaa	20616161
 four	20666F7572
afour	61666F7572
five	66697665
four	666F7572
four	666F7572
haf	686166
three	7468726565
zAz	7A417A
DROP TABLE IF EXISTS `sorting_temporal`;
CREATE TABLE `sorting_temporal`(
`dcolumn` DATE,
`tcolumn` TIME,
`dtcolumn` DATETIME,
`dtcolumn6` DATETIME(6)
) ENGINE=columnstore;
INSERT INTO `sorting_temporal`
(`dcolumn`,`tcolumn`,`dtcolumn`,`dtcolumn6`)
VALUES
('2001-01-01','00:00:00','2001-01-01 00:00:00.000001','2001-01-01 00:00:00.000001'),
('2001-01-01','00:00:00','2001-01-01 00:00:00.000001','2001-01-01 00:00:00.000002'),
(NULL,NULL,NULL,NULL),
('2042-02-24','23:23:42','2042-02-04 02:04:42.000001','2001-01-01 00:00:00.000001'),
(NULL,NULL,NULL,NULL),
('2005-05-21','05:05:42','2005-05-04 02:05:42.000001','2005-05-05 05:05:05.000005'),
(NULL,NULL,NULL,NULL);
SELECT `dcolumn` FROM `sorting_temporal` ORDER BY `dcolumn` DESC;
dcolumn
2042-02-24
2005-05-21
2001-01-01
2001-01-01
NULL
NULL
NULL
SELECT `dcolumn` FROM `sorting_temporal` ORDER BY `dcolumn` ASC;
dcolumn
NULL
NULL
NULL
2001-01-01
2001-01-01
2005-05-21
2042-02-24
SELECT `tcolumn` FROM `sorting_temporal` ORDER BY `tcolumn` DESC;
tcolumn
23:23:42
05:05:42
00:00:00
00:00:00
NULL
NULL
NULL
SELECT `tcolumn` FROM `sorting_temporal` ORDER BY `tcolumn` ASC;
tcolumn
NULL
NULL
NULL
00:00:00
00:00:00
05:05:42
23:23:42
SELECT `dtcolumn` FROM `sorting_temporal` ORDER BY `dtcolumn` DESC;
dtcolumn
2042-02-04 02:04:42
2005-05-04 02:05:42
2001-01-01 00:00:00
2001-01-01 00:00:00
NULL
NULL
NULL
SELECT `dtcolumn` FROM `sorting_temporal` ORDER BY `dtcolumn` ASC;
dtcolumn
NULL
NULL
NULL
2001-01-01 00:00:00
2001-01-01 00:00:00
2005-05-04 02:05:42
2042-02-04 02:04:42
SELECT `dtcolumn6` FROM `sorting_temporal` ORDER BY `dtcolumn6` DESC;
dtcolumn6
2005-05-05 05:05:05.000005
2001-01-01 00:00:00.000002
2001-01-01 00:00:00.000001
2001-01-01 00:00:00.000001
NULL
NULL
NULL
SELECT `dtcolumn6` FROM `sorting_temporal` ORDER BY `dtcolumn6` ASC;
dtcolumn6
NULL
NULL
NULL
2001-01-01 00:00:00.000001
2001-01-01 00:00:00.000001
2001-01-01 00:00:00.000002
2005-05-05 05:05:05.000005
DROP TABLE `sorting_numerics`;
DROP TABLE `sorting_chars`;
DROP TABLE `sorting_temporal`;
DROP DATABASE mcol3758;
