DROP DATABASE IF EXISTS q0122b;
CREATE DATABASE q0122b;
USE q0122b;
DROP TABLE if exists empsalary;
Warnings:
Note	1051	Unknown table 'q0122b.empsalary'
CREATE TABLE empsalary (
depname varchar(100),
empno bigint,
salary int,
enroll_date date
);
insert into empsalary values ('develop'  , 10, 5200, '2007-08-01');
insert into empsalary values ('sales'    ,  1, 5000, '2006-10-01');
insert into empsalary values ('personnel',  5, 3500, '2007-12-10');
insert into empsalary values ('sales'    ,  4, 4800, '2007-08-08');
insert into empsalary values ('personnel',  2, 3900, '2006-12-23');
insert into empsalary values ('develop'  ,  7, 4200, '2008-01-01');
insert into empsalary values ('develop'  ,  9, 4500, '2008-01-01');
insert into empsalary values ('sales'    ,  3, 4800, '2007-08-01');
insert into empsalary values ('develop'  ,  8, 6000, '2006-10-01');
insert into empsalary values ('develop'  , 11, 5200, '2007-08-15');
insert into empsalary values ('develop'  , 12, null, '2008-08-09');
SELECT COUNT(DISTINCT salary) OVER (PARTITION BY depname), salary, empno, depname from empsalary where empno < 10000 order by 4, ifnull(salary, 9999);
COUNT(DISTINCT salary) OVER (PARTITION BY depname)	salary	empno	depname
4	4200	7	develop
4	4500	9	develop
4	5200	11	develop
4	5200	10	develop
4	6000	8	develop
4	NULL	12	develop
2	3500	5	personnel
2	3900	2	personnel
2	4800	3	sales
2	4800	4	sales
2	5000	1	sales
DROP DATABASE q0122b;
